<p style="color: green"><%= notice %></p>

<div id='map' style='width: 100%; height: 400px; border-radius: 20px; shadow-box: 3px 3px 10px black;'></div>
<script>
// TO MAKE THE MAP APPEAR YOU MUST
// ADD YOUR ACCESS TOKEN FROM
// https://account.mapbox.com
mapboxgl.accessToken = 'pk.eyJ1Ijoia2Vsenp6ZXIiLCJhIjoiY2wzMXVxNjk4MGZxcjNpb2pxd3lqczRyaiJ9.IvHxJFJQDY5yoISmeC5Low';
var map = new mapboxgl.Map({
container: 'map', // container ID
style: 'mapbox://styles/mapbox/streets-v11', // style URL
center: [27.52, 53.89], // starting position [lng, lat]
zoom: 10 // starting zoom
});


map.on('style.load', function() {
map.on('click', function(e) {
  // console.log(e)
let coordinates = e.lngLat;
console.log(coordinates.lng)
  });
});


// Initialize the geolocate control.
var geolocate = new mapboxgl.GeolocateControl({
  positionOptions: {
    enableHighAccuracy: true
  },
  trackUserLocation: true
});
// Add the control to the map.
map.addControl(geolocate);
// Set an event listener that fires
// when a geolocate event occurs.
geolocate.on('geolocate', function() {
  console.log('A geolocate event has occurred.');
});



<% @users.each do |user| %>

var longitude = JSON.parse("<%= j user[:longitude]%>")
var latitude = JSON.parse("<%= j user[:latitude]%>")
var nameUser = "<%= j user[:first_name]%>"
// var srcUserFoto = "<%= j user[:foto]%>"
console.log('hello')
console.log(longitude + '  //  : '+latitude)
var marker_test = new mapboxgl.Marker()
.setLngLat([latitude,longitude])
.setPopup(new mapboxgl.Popup().setHTML(`
<div class="fotoUser" style="display: flex; flex-direction: column; width: 100%; height: 100%">
<h1 style="text-align: center;;">${nameUser}</h1>
<img src="" style="width: 50px; margin: 3px auto;">
<p>Descriptions</p>
</div>


`))
.addTo(map);
marker_test.togglePopup(); 
<% end %>
</script>

<h1>Users</h1>

<div id="users">
  <% @users.each do |user| %>
    <%= render user %>
    <p>
      <%= link_to "Show this user", user %>
    </p>
  <% end %>
</div>



<%= link_to "New user", new_user_path %>
